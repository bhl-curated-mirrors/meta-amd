From 99afa6c69e555c4bb87850e79d40cae82c3f5626 Mon Sep 17 00:00:00 2001
From: Alex Deucher <alexander.deucher@amd.com>
Date: Thu, 10 Aug 2017 14:15:27 -0400
Subject: [PATCH 0752/4131] drm/amd/display: fix up for DRM_ROTATE changes

Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
---
 drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
index c802dd8..83d2252 100644
--- a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
+++ b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
@@ -1683,17 +1683,17 @@ static bool fill_rects_from_plane_state(
 
 	plane_state->clip_rect = plane_state->dst_rect;
 
-	switch (state->rotation) {
-	case BIT(DRM_ROTATE_0):
+	switch (state->rotation & DRM_MODE_ROTATE_MASK) {
+	case DRM_MODE_ROTATE_0:
 		plane_state->rotation = ROTATION_ANGLE_0;
 		break;
-	case BIT(DRM_ROTATE_90):
+	case DRM_MODE_ROTATE_90:
 		plane_state->rotation = ROTATION_ANGLE_90;
 		break;
-	case BIT(DRM_ROTATE_180):
+	case DRM_MODE_ROTATE_180:
 		plane_state->rotation = ROTATION_ANGLE_180;
 		break;
-	case BIT(DRM_ROTATE_270):
+	case DRM_MODE_ROTATE_270:
 		plane_state->rotation = ROTATION_ANGLE_270;
 		break;
 	default:
@@ -2952,7 +2952,7 @@ static void dm_drm_plane_reset(struct drm_plane *plane)
 	if (amdgpu_state) {
 		plane->state = &amdgpu_state->base;
 		plane->state->plane = plane;
-		plane->state->rotation = DRM_ROTATE_0;
+		plane->state->rotation = DRM_MODE_ROTATE_0;
 	} else
 		WARN_ON(1);
 }
-- 
2.7.4

