From 26e564301dc195bc825503ef5382e929b623633a Mon Sep 17 00:00:00 2001
From: xinhui pan <xinhui.pan@amd.com>
Date: Mon, 11 Mar 2019 14:28:06 +0800
Subject: [PATCH 1604/2940] drm/amdgpu: Fix warning when lockdep is enabled

Set ignore bit to satisfy locpdep.

Signed-off-by: xinhui pan <xinhui.pan@amd.com>
Reviewed-by: Evan Quan <evan.quan@amd.com>
---
 drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
index bf462c59cb76..750087535f00 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
@@ -740,6 +740,9 @@ static int amdgpu_ras_sysfs_create_feature_node(struct amdgpu_device *adev)
 		.attr = {
 			.name = "features",
 			.mode = S_IRUGO,
+#ifdef CONFIG_DEBUG_LOCK_ALLOC
+			.ignore_lockdep = 1,
+#endif
 		},
 			.show = amdgpu_ras_sysfs_features_read,
 	};
@@ -782,6 +785,9 @@ int amdgpu_ras_sysfs_create(struct amdgpu_device *adev,
 		.attr = {
 			.name = obj->fs_data.sysfs_name,
 			.mode = S_IRUGO,
+#ifdef CONFIG_DEBUG_LOCK_ALLOC
+			.ignore_lockdep = 1,
+#endif
 		},
 			.show = amdgpu_ras_sysfs_read,
 	};
-- 
2.17.1

