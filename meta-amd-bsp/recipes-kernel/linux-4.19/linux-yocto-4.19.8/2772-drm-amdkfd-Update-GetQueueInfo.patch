From 5ab169ed83c5ee596df527415ede2edc4fe37326 Mon Sep 17 00:00:00 2001
From: Laurent Morichetti <laurent.morichetti@amd.com>
Date: Sat, 4 May 2019 19:19:05 -0700
Subject: [PATCH 2772/2940] drm/amdkfd: Update GetQueueInfo

Fix the reported wave_state_offset.

Change-Id: Ia68943dcc5cdd08af29da6a73f625e57dfbb652d
Signed-off-by: Laurent Morichetti <laurent.morichetti@amd.com>
---
 drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v9.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v9.c b/drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v9.c
index 2cb0aaaf4e3b..089df51e0f5e 100644
--- a/drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v9.c
+++ b/drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v9.c
@@ -381,7 +381,7 @@ static int get_wave_state(struct mqd_manager *mm, void *mqd,
 	header.control_stack_size = *ctl_stack_used_size;
 	header.wave_state_size = *save_area_used_size;
 
-	header.wave_state_offset = m->cp_hqd_wg_state_offset + sizeof(header);
+	header.wave_state_offset = m->cp_hqd_wg_state_offset;
 	header.control_stack_offset = m->cp_hqd_cntl_stack_offset;
 
 	if (copy_to_user(ctl_stack, &header, sizeof(header)))
-- 
2.17.1

