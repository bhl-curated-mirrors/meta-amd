From 9be1a3439437e52364a3434d1a181c32aaf48fce Mon Sep 17 00:00:00 2001
From: Evan Quan <evan.quan@amd.com>
Date: Fri, 14 Jun 2019 17:04:36 +0800
Subject: [PATCH 2591/2940] drm/amd/powerplay: check gfxclk dpm enablement
 before proceeding

Support gfxclk dpm disablement.

Change-Id: I9bc2dbb5f4440f91cd631a118ae7f120888f4a96
Signed-off-by: Evan Quan <evan.quan@amd.com>
Reviewed-by: Feifei Xu <Feifei.Xu@amd.com>
Reviewed-by: Kevin Wang <kevin1.wang@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
---
 drivers/gpu/drm/amd/powerplay/amdgpu_smu.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/amd/powerplay/amdgpu_smu.c b/drivers/gpu/drm/amd/powerplay/amdgpu_smu.c
index fe83c5e3111f..38ce6a5a628f 100644
--- a/drivers/gpu/drm/amd/powerplay/amdgpu_smu.c
+++ b/drivers/gpu/drm/amd/powerplay/amdgpu_smu.c
@@ -143,6 +143,7 @@ int smu_get_dpm_freq_range(struct smu_context *smu, enum smu_clk_type clk_type,
 		}
 		break;
 	case SMU_GFXCLK:
+	case SMU_SCLK:
 		if (!smu_feature_is_enabled(smu, SMU_FEATURE_DPM_GFXCLK_BIT)) {
 			pr_warn("gfxclk dpm is not enabled\n");
 			return 0;
-- 
2.17.1

