From 8c23f930a6dd3be67586d155a20e2e585e4a370e Mon Sep 17 00:00:00 2001
From: Slava Abramov <slava.abramov@amd.com>
Date: Thu, 16 May 2019 16:17:53 -0400
Subject: [PATCH 1985/2940] drm/amdgpu: use div64_ul for 32-bit compatibility
 v1

v1: replace casting to unsigned long with div64_ul

Change-Id: Ia48671ed0756bb73c7b4760a800bcb6f600cbef2
Signed-off-by: Slava Abramov <slava.abramov@amd.com>
Tested-by: Slava Abramov <slava.abramov@amd.com>
---
 drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c b/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
index da1dc40b9b14..d5719b0fb82c 100644
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c
@@ -764,8 +764,8 @@ static ssize_t amdgpu_ras_sysfs_badpages_read(struct file *f,
 	struct amdgpu_device *adev = con->adev;
 	const unsigned int element_size =
 		sizeof("0xabcdabcd : 0x12345678 : R\n") - 1;
-	unsigned int start = (ppos + element_size - 1) / element_size;
-	unsigned int end = (ppos + count - 1) / element_size;
+	unsigned int start = div64_ul(ppos + element_size - 1, element_size);
+	unsigned int end = div64_ul(ppos + count - 1, element_size);
 	ssize_t s = 0;
 	struct ras_badpage *bps = NULL;
 	unsigned int bps_count = 0;
-- 
2.17.1

